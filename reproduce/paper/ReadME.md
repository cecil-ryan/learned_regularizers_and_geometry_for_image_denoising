# GFTNRD

This directory contains code to reproduce the main results table from our paper on 
[Learned Regularizers and Geometry for Image Denoising](https://www.bmvc2021-virtualconference.com/assets/papers/1117.pdf).

The code directory contains a file titled ``train_test_gftnrd_models.py`` which
will train and test the appropriate TNRD and GFTNRD models on the BSDS400 and BSDS68 dataset. The results 
will be stored in the ``results`` directory. Please note that the training approach used to 
generate these results are slightly different from the original implementation in our paper.

|             |        | **sigma=15** |        |      |       |sigma=25 |      |      |      |sigma=50 |      |      |
|-------------|--------|--------------|--------|------|-------|--------|------|------|------|------|------|------|
| **stage 3** |**G 3x3**   | **G 5x5**        |**G 7x7**   |**G 9x9** | **G 3x3** |**G 5x5**   |**G 7x7** |**G 9x9** |**G 3x3** |**G 5x5** |**G 7x7** |**G 9x9** |
| **TNRD**        |30.83   | 31.22        |31.38   |31.46 | 28.28 |28.69   |28.86 |28.96 |25.24 |25.73 |25.91 |26.00 |
| **F 3**         |30.87   | 31.23        |31.40   |31.47 | 28.31 |28.69   |28.87 |28.98 |25.29 |25.75 |25.94 |26.01 |
| **F 5**         |31.12   | 31.26        |31.41   |31.48 | 28.52 |28.71   |28.87 |28.97 |25.44 |25.75 |25.95 |26.05 |
| **F 7**         |31.19   | 31.30        |31.42   |31.49 | 28.66 |28.81   |28.89 |28.98 |25.59 |25.76 |25.96 |26.05 |
| **F 9**         |31.29   | 31.37        |31.44   |31.50 | 28.72 |28.84   |28.92 |28.99 |25.66 |25.87 |25.96 |26.05 |
| **stage 5**     |**G 3x3**   | **G 5x5**        |**G 7x7**   |**G 9x9** | **G 3x3** |**G 5x5**   |**G 7x7** |**G 9x9** |**G 3x3** |**G 5x5** |**G 7x7** |**G 9x9** |
| **TNRD**        |30.94   | 31.31        |31.45   |31.52 | 28.43 |28.78   |28.95 |29.04 |25.43 |25.82 |26.01 |26.11 |
| **F 3**         |30.99   | 31.33        |31.46   |31.53 | 28.45 |28.80   |28.96 |29.05 |25.46 |25.84 |26.02 |26.12 |
| **F 5**         |31.17   | 31.36        |31.48   |31.55 | 28.61 |28.81   |28.96 |29.05 |25.60 |25.85 |26.03 |26.13 |
| **F 7**         |31.29   | 31.40        |31.48   |31.54 | 28.70 |28.88   |28.96 |29.05 |25.70 |25.91 |26.04 |26.13 |
| **F 9**         |31.34   | 31.42        |31.50   |31.55 | 28.79 |28.93   |29.01 |29.06 |25.78 |25.96 |26.07 |26.12 |
| **stage 7**     |**G 3x3**   | **G 5x5**        |**G 7x7**   |**G 9x9** | **G 3x3** |**G 5x5**   |**G 7x7** |**G 9x9** |**G 3x3** |**G 5x5** |**G 7x7** |**G 9x9** |
| **TNRD**        |31.00   | 31.36        |31.49   |31.56 | 28.51 |28.84   |29.00 |29.07 |25.55 |25.88 |26.05 |26.15 |
| **F 3**         |31.07   | 31.37        |31.50   |31.56 | 28.52 |28.85   |29.00 |29.08 |25.55 |25.90 |26.07 |26.17 |
| **F 5**         |31.23   | 31.39        |31.51   |31.57 | 28.67 |28.86   |29.00 |29.08 |25.65 |25.92 |26.08 |26.17 |
| **F 7**         |31.30   | 31.44        |31.51   |31.58 | 28.76 |28.92   |29.00 |29.09 |25.76 |25.97 |26.08 |26.18 |
| **F 9**         |31.38   | 31.48        |31.53   |31.59 | 28.83 |28.94  | 29.03 | 29.09 | 25.83 | 26.00 | 26.11 | 26.17
